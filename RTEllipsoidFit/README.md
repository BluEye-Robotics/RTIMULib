# RTEllipsoidFit

Written by Andreas Viggen

Elliptic_fit.py is used to generate magCorr.dta. This script is dependent on magRaw.dta, which is generated by the first step in the calibration procedure, min-max of magnetic field.

Execute with

```python
cd RTIMULib/RTEllipsoidFit
python EllipticFit.py
```

mag_cal.py is used to compare the new calibrated sphere with the old one.

```python
cd RTIMULib/RTEllipsoidFit
python mag_cal.py
```

The created file `magCorr.dta` will now be used by the lib to correct the heading measurements.

The output of magCorr.dta should be similar to this:
```
-1.607051 3.115048 -0.967425 0.961812 -0.020831 -0.020937 -0.020831 0.982669 -0.029818 -0.020937 -0.029818 0.931808
```
where the three first numbers are representing the translation, and the six remaining numbers are defining the distortion of the sphere. It is a 3 by 3 matrix that will be close to the identity matrix. The identity matrix represents 0 distortion.
```
0.961812 -0.020831 -0.020937
-0.020831 0.982669 -0.029818
-0.020937 -0.029818 0.931808
```
Slightly skewed identity matrix means that its correction is not critical.

# Installing RTIMULib on Linux

```
git clone https://github.com/RPi-Distro/RTIMULib.git
cd RTIMULib/RTIMULib
mkdir build
cd build
cmake ..
make
make install
```
You can always make the lib again with the steps starting from `cmake ..` if you make some changes to the .cpp files in the lib.
